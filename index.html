<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Music Library</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, sans-serif;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            min-height: 100vh;
            padding: 20px;
            overflow-x: hidden;
            -webkit-text-size-adjust: none;
            color: white;
            overscroll-behavior: none;
        }

        .container {
            background: rgba(25, 25, 35, 0.95);
            border-radius: 20px;
            padding: 25px;
            max-width: 800px;
            margin: 0 auto;
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.4);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .header {
            text-align: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        h1 {
            color: #00ff88;
            font-size: 32px;
            font-weight: 700;
            margin-bottom: 10px;
            text-shadow: 0 2px 10px rgba(0, 255, 136, 0.3);
        }

        .subtitle {
            color: #8a8aa3;
            font-size: 16px;
            margin-bottom: 20px;
        }

        .stats {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-top: 15px;
        }

        .stat-item {
            background: rgba(255, 255, 255, 0.05);
            padding: 10px 20px;
            border-radius: 10px;
            text-align: center;
            min-width: 120px;
        }

        .stat-value {
            font-size: 24px;
            font-weight: 700;
            color: #00ff88;
            margin-bottom: 5px;
        }

        .stat-label {
            font-size: 12px;
            color: #8a8aa3;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .filter-bar {
            display: flex;
            gap: 15px;
            margin-bottom: 25px;
            flex-wrap: wrap;
        }

        .search-box {
            flex: 1;
            min-width: 200px;
            position: relative;
        }

        .search-input {
            width: 100%;
            padding: 15px 20px 15px 50px;
            background: rgba(255, 255, 255, 0.07);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            color: white;
            font-size: 16px;
            outline: none;
            transition: all 0.3s;
        }

        .search-input:focus {
            border-color: #00ff88;
            box-shadow: 0 0 0 2px rgba(0, 255, 136, 0.2);
        }

        .search-icon {
            position: absolute;
            left: 20px;
            top: 50%;
            transform: translateY(-50%);
            color: #8a8aa3;
            font-size: 18px;
        }

        .filter-btn {
            padding: 15px 25px;
            background: rgba(255, 255, 255, 0.07);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            color: white;
            font-size: 14px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 10px;
            transition: all 0.3s;
        }

        .filter-btn:hover {
            background: rgba(0, 255, 136, 0.1);
            border-color: #00ff88;
        }

        .filter-btn.active {
            background: rgba(0, 255, 136, 0.2);
            border-color: #00ff88;
            color: #00ff88;
        }

        .music-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .music-card {
            background: rgba(255, 255, 255, 0.03);
            border-radius: 15px;
            padding: 20px;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            border: 1px solid transparent;
            backdrop-filter: blur(10px);
            position: relative;
            overflow: hidden;
        }

        .music-card:hover {
            transform: translateY(-5px);
            background: rgba(255, 255, 255, 0.08);
            border-color: rgba(0, 255, 136, 0.3);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
        }

        .music-card:active {
            transform: translateY(-2px);
        }

        .music-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, #00ff88 0%, #00cc6a 100%);
            opacity: 0;
            transition: opacity 0.3s;
        }

        .music-card:hover::before {
            opacity: 1;
        }

        .music-cover {
            width: 100%;
            height: 160px;
            background: linear-gradient(135deg, #00ff88 0%, #00cc6a 100%);
            border-radius: 10px;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 50px;
            overflow: hidden;
            position: relative;
        }

        .music-cover::before {
            content: '';
            position: absolute;
            width: 40px;
            height: 40px;
            background: #1a1a2e;
            border-radius: 50%;
            border: 3px solid rgba(255, 255, 255, 0.1);
        }

        .music-info {
            text-align: center;
        }

        .music-title {
            font-size: 16px;
            font-weight: 600;
            margin-bottom: 5px;
            color: white;
            line-height: 1.4;
            height: 45px;
            overflow: hidden;
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
        }

        .music-artist {
            font-size: 14px;
            color: #8a8aa3;
            margin-bottom: 10px;
        }

        .music-duration {
            font-size: 12px;
            color: #00ff88;
            background: rgba(0, 255, 136, 0.1);
            padding: 4px 10px;
            border-radius: 20px;
            display: inline-block;
        }

        .play-button {
            position: absolute;
            top: 20px;
            right: 20px;
            width: 40px;
            height: 40px;
            background: rgba(0, 0, 0, 0.7);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 18px;
            opacity: 0;
            transform: scale(0.8);
            transition: all 0.3s;
        }

        .music-card:hover .play-button {
            opacity: 1;
            transform: scale(1);
        }

        .play-button:hover {
            background: #00ff88;
            color: black;
        }

        .player-actions {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-top: 30px;
            padding-top: 25px;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
        }

        .action-btn {
            padding: 18px 35px;
            background: linear-gradient(135deg, #00ff88 0%, #00cc6a 100%);
            border: none;
            border-radius: 15px;
            color: black;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 12px;
            transition: all 0.3s;
            min-width: 200px;
            box-shadow: 0 5px 20px rgba(0, 255, 136, 0.3);
        }

        .action-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(0, 255, 136, 0.4);
        }

        .action-btn:active {
            transform: translateY(-1px);
        }

        .action-btn.secondary {
            background: rgba(255, 255, 255, 0.1);
            color: white;
            box-shadow: none;
        }

        .action-btn.secondary:hover {
            background: rgba(255, 255, 255, 0.2);
        }

        .loading {
            text-align: center;
            padding: 40px;
            color: #8a8aa3;
            font-size: 16px;
        }

        .loading-spinner {
            width: 40px;
            height: 40px;
            border: 3px solid rgba(255, 255, 255, 0.1);
            border-top-color: #00ff88;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto 20px;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        @media (max-width: 768px) {
            .container {
                padding: 20px;
            }
            
            h1 {
                font-size: 24px;
            }
            
            .music-grid {
                grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
                gap: 15px;
            }
            
            .stats {
                flex-direction: column;
                align-items: center;
                gap: 10px;
            }
            
            .stat-item {
                width: 100%;
                max-width: 200px;
            }
            
            .player-actions {
                flex-direction: column;
            }
            
            .action-btn {
                width: 100%;
                min-width: auto;
            }
        }

        @media (max-width: 480px) {
            .music-grid {
                grid-template-columns: 1fr;
            }
            
            .filter-bar {
                flex-direction: column;
            }
            
            .search-box {
                min-width: auto;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üéµ Music Library</h1>
            <div class="subtitle">Ch·ªçn b√†i h√°t y√™u th√≠ch c·ªßa b·∫°n</div>
            
            <div class="stats">
                <div class="stat-item">
                    <div class="stat-value" id="totalSongs">0</div>
                    <div class="stat-label">B√†i h√°t</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value" id="totalArtists">0</div>
                    <div class="stat-label">Ngh·ªá sƒ©</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value" id="totalDuration">0:00</div>
                    <div class="stat-label">T·ªïng th·ªùi gian</div>
                </div>
            </div>
        </div>

        <div class="filter-bar">
            <div class="search-box">
                <span class="search-icon">üîç</span>
                <input type="text" class="search-input" id="searchInput" placeholder="T√¨m ki·∫øm b√†i h√°t ho·∫∑c ngh·ªá sƒ©...">
            </div>
            
            <button class="filter-btn" id="filterAll" data-filter="all">
                <span>üéµ</span>
                T·∫•t c·∫£
            </button>
        </div>

        <div class="loading" id="loading">
            <div class="loading-spinner"></div>
            <div>ƒêang t·∫£i danh s√°ch nh·∫°c...</div>
        </div>

        <div class="music-grid" id="musicGrid">
            <!-- Music cards s·∫Ω ƒë∆∞·ª£c t·∫£i ƒë·ªông -->
        </div>

        <div class="player-actions">
            <button class="action-btn" id="playSelectedBtn">
                <span>‚ñ∂Ô∏è</span>
                Ph√°t b√†i ƒë√£ ch·ªçn
            </button>
            
            <button class="action-btn secondary" id="playRandomBtn">
                <span>üîÄ</span>
                Ph√°t ng·∫´u nhi√™n
            </button>
            
            <button class="action-btn secondary" id="playAllBtn">
                <span>üéµ</span>
                Ph√°t t·∫•t c·∫£
            </button>
        </div>
    </div>

    <script>
        // ================= C·∫§U H√åNH =================
        const MUSIC_FOLDER = 'music/';
        let allSongs = [];
        let filteredSongs = [];
        let selectedSongs = new Set();
        
        // ================= DOM ELEMENTS =================
        const loadingEl = document.getElementById('loading');
        const musicGridEl = document.getElementById('musicGrid');
        const searchInput = document.getElementById('searchInput');
        const filterBtns = document.querySelectorAll('.filter-btn');
        const totalSongsEl = document.getElementById('totalSongs');
        const totalArtistsEl = document.getElementById('totalArtists');
        const totalDurationEl = document.getElementById('totalDuration');
        const playSelectedBtn = document.getElementById('playSelectedBtn');
        const playRandomBtn = document.getElementById('playRandomBtn');
        const playAllBtn = document.getElementById('playAllBtn');
        
        // ================= KH·ªûI T·∫†O =================
        async function init() {
            showLoading();
            await loadMusicLibrary();
            renderMusicGrid();
            updateStats();
            hideLoading();
        }
        
        // ================= T·∫¢I TH∆Ø VI·ªÜN NH·∫†C =================
        async function loadMusicLibrary() {
            try {
                // Th·ª≠ t·∫£i t·ª´ file list.json
                const response = await fetch(`${MUSIC_FOLDER}list.json`);
                
                if (response.ok) {
                    const data = await response.json();
                    allSongs = data.map(song => ({
                        id: generateId(),
                        title: song.title || extractTitleFromFileName(song.file),
                        artist: song.artist || "Ngh·ªá sƒ©",
                        file: song.file,
                        duration: song.duration || 180, // M·∫∑c ƒë·ªãnh 3 ph√∫t
                        playCount: Math.floor(Math.random() * 100), // D·ªØ li·ªáu m·∫´u
                        addedDate: getRandomDate()
                    }));
                } else {
                    // T·∫°o t·ª´ danh s√°ch file
                    allSongs = await createMusicListFromFolder();
                }
                
                filteredSongs = [...allSongs];
                
            } catch (error) {
                console.log('L·ªói t·∫£i danh s√°ch nh·∫°c:', error);
                allSongs = getSampleSongs();
                filteredSongs = [...allSongs];
            }
        }
        
        // T·∫°o danh s√°ch nh·∫°c t·ª´ file trong th∆∞ m·ª•c
        async function createMusicListFromFolder() {
            const musicFiles = [
                "(151) Co Em Cho - Min (prod.orio) remix - YouTube.mp3",
                "(151) EREN - ANHDAUMUON feat. younghao, Bbynascar, Left Hand (OFFICIAL MV) - YouTube.mp3",
                "(151) EREN - Mua Dong Em Ve (ft. Bbynascar, Taki) - YouTube.mp3",
                "(151) FALLING IN LOVE (prod.orio) remix - YouTube.mp3",
                "(151) Gi·ªØ L·∫•y L√†m G√å - MONSTAR (prod. orizz) Drill - TikTok VER (Remake) - YouTube.mp3",
                "(151) h√£y cho con ch·ªãu ƒëau kh·ªï thay em - Lill.iem & ekkososa (feat. Kewwi, KIDDI) - remake - YouTube.mp3",
                "(151) HONGKONG1 (remake) - 52HZ ‚Äì (Lyrics) - YouTube.mp3",
                "(151) KayC - The One For Me (feat. VSTRA & Machiot) - THE ONE- ALBUM - YouTube.mp3",
                "(151) K√âM DUY√äN (remix by Higo) - YouTube.mp3",
                "(151) Obito - H√† N·ªôi ft. VSTRA - YouTube.mp3",
                "(151) QUA NG√ÄY MAI - Ti√™n Ti·∫øn ( Remake ) - YouTube.mp3",
                "(151) TGSN - Out Of Body (feat. VSTRA & tlinh) - YouTube.mp3",
                "(151) Tinh lu Mau Nang - YouTube.mp3",
                "(151) V√¥ Tinh (@htingale x itsnyuuko remix) - Remake - YouTube.mp3"
            ];
            
            return musicFiles.map((file, index) => {
                const cleanName = file
                    .replace(/^\(\d+\)\s*/, '')
                    .replace(/\.mp3$/, '')
                    .replace(/\s*-\s*YouTube$/, '')
                    .replace(/\s*\(\d+\)$/, '')
                    .trim();
                
                let title = cleanName;
                let artist = "Ngh·ªá sƒ©";
                
                const dashIndex = cleanName.indexOf(' - ');
                if (dashIndex !== -1) {
                    artist = cleanName.substring(0, dashIndex).trim();
                    title = cleanName.substring(dashIndex + 3).trim();
                }
                
                if (cleanName.includes(' ft. ') || cleanName.includes(' feat. ')) {
                    const ftIndex = Math.max(
                        cleanName.indexOf(' ft. '),
                        cleanName.indexOf(' feat. ')
                    );
                    if (ftIndex !== -1) {
                        title = cleanName.substring(0, ftIndex).trim();
                    }
                }
                
                return {
                    id: generateId(),
                    title: title || "B√†i h√°t kh√¥ng t√™n",
                    artist: artist || "Ngh·ªá sƒ©",
                    file: file,
                    duration: 180 + (index * 30), // Th·ªùi gian tƒÉng d·∫ßn
                    playCount: Math.floor(Math.random() * 100),
                    addedDate: getRandomDate()
                };
            });
        }
        
        function getSampleSongs() {
            return Array.from({ length: 8 }, (_, i) => ({
                id: generateId(),
                title: `B√†i h√°t m·∫´u ${i + 1}`,
                artist: `Ngh·ªá sƒ© ${i + 1}`,
                file: `sample${i + 1}.mp3`,
                duration: 180 + (i * 30),
                playCount: Math.floor(Math.random() * 100),
                addedDate: getRandomDate()
            }));
        }
        
        // ================= RENDER GIAO DI·ªÜN =================
        function renderMusicGrid() {
            musicGridEl.innerHTML = '';
            
            if (filteredSongs.length === 0) {
                musicGridEl.innerHTML = `
                    <div style="grid-column: 1 / -1; text-align: center; padding: 40px; color: #8a8aa3;">
                        <div style="font-size: 48px; margin-bottom: 20px;">üéµ</div>
                        <p style="font-size: 18px; margin-bottom: 10px;">Kh√¥ng t√¨m th·∫•y b√†i h√°t</p>
                        <p style="font-size: 14px;">Th·ª≠ t√¨m ki·∫øm v·ªõi t·ª´ kh√≥a kh√°c</p>
                    </div>
                `;
                return;
            }
            
            filteredSongs.forEach(song => {
                const card = document.createElement('div');
                card.className = 'music-card';
                card.dataset.id = song.id;
                
                const duration = formatTime(song.duration);
                const isSelected = selectedSongs.has(song.id);
                
                card.innerHTML = `
                    <div class="music-cover">
                        ${getMusicEmoji(song.title)}
                    </div>
                    <div class="play-button" data-id="${song.id}">
                        ${isSelected ? '‚úì' : '‚ñ∂Ô∏è'}
                    </div>
                    <div class="music-info">
                        <div class="music-title" title="${song.title}">${song.title}</div>
                        <div class="music-artist">${song.artist}</div>
                        <div class="music-duration">${duration}</div>
                    </div>
                `;
                
                // Click ƒë·ªÉ ch·ªçn b√†i h√°t
                card.addEventListener('click', (e) => {
                    if (!e.target.classList.contains('play-button')) {
                        toggleSelectSong(song.id, card);
                    }
                });
                
                // Click n√∫t play ƒë·ªÉ preview
                const playBtn = card.querySelector('.play-button');
                playBtn.addEventListener('click', (e) => {
                    e.stopPropagation();
                    toggleSelectSong(song.id, card);
                });
                
                musicGridEl.appendChild(card);
            });
        }
        
        function toggleSelectSong(songId, card) {
            if (selectedSongs.has(songId)) {
                selectedSongs.delete(songId);
                card.querySelector('.play-button').textContent = '‚ñ∂Ô∏è';
                card.style.borderColor = 'transparent';
                card.style.background = 'rgba(255, 255, 255, 0.03)';
            } else {
                selectedSongs.add(songId);
                card.querySelector('.play-button').textContent = '‚úì';
                card.style.borderColor = '#00ff88';
                card.style.background = 'rgba(0, 255, 136, 0.1)';
            }
            
            updatePlayButton();
        }
        
        function updatePlayButton() {
            const count = selectedSongs.size;
            if (count === 0) {
                playSelectedBtn.innerHTML = '<span>‚ñ∂Ô∏è</span> Ph√°t b√†i ƒë√£ ch·ªçn';
                playSelectedBtn.disabled = true;
                playSelectedBtn.style.opacity = '0.5';
            } else {
                playSelectedBtn.innerHTML = `<span>‚ñ∂Ô∏è</span> Ph√°t ${count} b√†i ƒë√£ ch·ªçn`;
                playSelectedBtn.disabled = false;
                playSelectedBtn.style.opacity = '1';
            }
        }
        
        // ================= FILTER & SEARCH =================
        function filterSongs() {
            const searchTerm = searchInput.value.toLowerCase();
            const activeFilter = document.querySelector('.filter-btn.active').dataset.filter;
            
            filteredSongs = allSongs.filter(song => {
                // T√¨m ki·∫øm
                const matchesSearch = !searchTerm || 
                    song.title.toLowerCase().includes(searchTerm) ||
                    song.artist.toLowerCase().includes(searchTerm);
                
                if (!matchesSearch) return false;
                
                // L·ªçc theo lo·∫°i
                switch (activeFilter) {
                    case 'recent':
                        // Gi·∫£ s·ª≠ b√†i h√°t ƒë∆∞·ª£c th√™m g·∫ßn ƒë√¢y
                        return song.playCount < 50; // D·ªØ li·ªáu m·∫´u
                    case 'popular':
                        return song.playCount >= 50; // D·ªØ li·ªáu m·∫´u
                    default:
                        return true;
                }
            });
            
            renderMusicGrid();
        }
        
        // ================= TH·ªêNG K√ä =================
        function updateStats() {
            totalSongsEl.textContent = allSongs.length;
            
            // ƒê·∫øm s·ªë ngh·ªá sƒ© duy nh·∫•t
            const uniqueArtists = new Set(allSongs.map(song => song.artist));
            totalArtistsEl.textContent = uniqueArtists.size;
            
            // T√≠nh t·ªïng th·ªùi gian
            const totalSeconds = allSongs.reduce((sum, song) => sum + song.duration, 0);
            totalDurationEl.textContent = formatTime(totalSeconds);
        }
        
        // ================= TI·ªÜN √çCH =================
        function generateId() {
            return Math.random().toString(36).substr(2, 9);
        }
        
        function extractTitleFromFileName(fileName) {
            return fileName
                .replace(/^\(\d+\)\s*/, '')
                .replace(/\.mp3$/, '')
                .replace(/\s*-\s*YouTube$/, '')
                .replace(/\s*\(\d+\)$/, '')
                .trim();
        }
        
        function formatTime(seconds) {
            if (isNaN(seconds)) return '0:00';
            const hours = Math.floor(seconds / 3600);
            const mins = Math.floor((seconds % 3600) / 60);
            const secs = Math.floor(seconds % 60);
            
            if (hours > 0) {
                return `${hours}:${mins.toString().padStart(2, '0')}:${secs.toString().padStart(2, '0')}`;
            }
            return `${mins}:${secs.toString().padStart(2, '0')}`;
        }
        
        function getMusicEmoji(title) {
            const emojis = ['üéµ', 'üé∂', 'üé§', 'üéß', 'üé∏', 'ü•Å', 'üé∑', 'üéπ', 'üé∫', 'ü™ï'];
            const index = title.length % emojis.length;
            return emojis[index];
        }
        
        function getRandomDate() {
            const start = new Date(2023, 0, 1);
            const end = new Date();
            return new Date(start.getTime() + Math.random() * (end.getTime() - start.getTime()));
        }
        
        function showLoading() {
            loadingEl.style.display = 'block';
            musicGridEl.style.display = 'none';
        }
        
        function hideLoading() {
            loadingEl.style.display = 'none';
            musicGridEl.style.display = 'grid';
        }
        
        function getSelectedSongs() {
            return allSongs.filter(song => selectedSongs.has(song.id));
        }
        
        function getRandomSongs(count = 10) {
            const shuffled = [...allSongs].sort(() => 0.5 - Math.random());
            return shuffled.slice(0, Math.min(count, allSongs.length));
        }
        
        // ================= EVENT LISTENERS =================
        searchInput.addEventListener('input', filterSongs);
        
        filterBtns.forEach(btn => {
            btn.addEventListener('click', () => {
                filterBtns.forEach(b => b.classList.remove('active'));
                btn.classList.add('active');
                filterSongs();
            });
        });
        
        playSelectedBtn.addEventListener('click', () => {
            const songs = getSelectedSongs();
            if (songs.length > 0) {
                localStorage.setItem('playlist', JSON.stringify(songs));
                localStorage.setItem('playMode', 'sequential');
                localStorage.setItem('currentIndex', '0');
                window.location.href = 'player.html';
            }
        });
        
        playRandomBtn.addEventListener('click', () => {
            const songs = getRandomSongs();
            localStorage.setItem('playlist', JSON.stringify(songs));
            localStorage.setItem('playMode', 'shuffle');
            localStorage.setItem('currentIndex', '0');
            window.location.href = 'player.html';
        });
        
        playAllBtn.addEventListener('click', () => {
            localStorage.setItem('playlist', JSON.stringify(allSongs));
            localStorage.setItem('playMode', 'sequential');
            localStorage.setItem('currentIndex', '0');
            window.location.href = 'player.html';
        });
        
        // ================= KH·ªûI CH·∫†Y =================
        init();
        updatePlayButton();
        
        // K√≠ch ho·∫°t filter m·∫∑c ƒë·ªãnh
        document.getElementById('filterAll').classList.add('active');
    </script>
</body>
</html>